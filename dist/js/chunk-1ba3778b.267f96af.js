(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1ba3778b"],{"72ca":function(t,e,a){"use strict";var s=a("f072"),i=a.n(s);i.a},"94a0":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"container"},[a("div",{staticClass:"messaging"},[a("div",{staticClass:"inbox_msg"},[a("div",{staticClass:"inbox_people"},[t._m(0),a("div",{staticClass:"inbox_chat"},t._l(t.contacts,(function(e){return a("div",{key:e,staticClass:"chat_list active_chat"},[a("div",{staticClass:"chat people"},[a("div",{staticClass:"chat_ib"},[a("h5",[t._v(t._s(e.username))]),a("v-btn",{style:{align:"center",color:"#FFFFFF"},attrs:{color:"#F1BA79",tile:"",outlined:""},on:{click:function(a){t.select(e.name),t.fetchMessages()}}},[t._v(" Start messaging ")]),a("v-btn",{style:{align:"center",color:"#FFFFFF",float:"right"},attrs:{color:"#F1BA79",tile:"",outlined:""},on:{click:function(a){t.select(e.name),t.addNew()}}},[t._v("Schedule session")])],1)])])})),0)]),a("div",{staticClass:"mesgs"},[a("div",{staticClass:"msg_history"},t._l(t.messages,(function(e){return a("div",{key:e,staticClass:"incoming_msg"},[a("div",{class:[e.author===t.authUser.email?"sent_msg":"received_msg"]},[a("div",{staticClass:"received_withd_msg"},[a("p",[t._v(" "+t._s(e.message)+" ")]),a("span",{staticClass:"time_date"},[t._v(t._s(e.createdAt.toDate().getMonth()+"/"+e.createdAt.toDate().getDate()+" "+e.createdAt.toDate().getHours()+":"+e.createdAt.toDate().getMinutes())+"||"+t._s(e.author))])])])])})),0),a("div",{staticClass:"type_msg"},[a("div",{staticClass:"input_msg_write"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.message,expression:"message"}],staticClass:"write_msg",attrs:{type:"text",placeholder:"Type a message"},domProps:{value:t.message},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.saveMessage(e)},input:function(e){e.target.composing||(t.message=e.target.value)}}}),t._m(1)])])])])]),a("div",{staticClass:"modal fade",attrs:{id:"module",tabindex:"-1",role:"dialog","aria-labelledby":"editLabel","aria-hidden":"true"}},[a("div",{staticClass:"modal-dialog modal-lg",attrs:{role:"document"}},[a("div",{staticClass:"modal-content"},[t._m(2),a("div",{staticClass:"modal-body"},[t._v(" Module "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.module,expression:"module"}],staticClass:"mod_input",attrs:{type:"text"},domProps:{value:t.module},on:{input:function(e){e.target.composing||(t.module=e.target.value)}}}),a("v-spacer"),a("br"),t._v(" Date "),a("br"),a("v-date-picker",{attrs:{"no-title":"",scrollable:""},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}}),a("v-spacer"),t._v(" Time "),a("br"),a("v-time-picker",{model:{value:t.time,callback:function(e){t.time=e},expression:"time"}})],1),a("div",{staticClass:"modal-footer"},[a("button",{staticClass:"btn btn-secondary",attrs:{type:"button","data-dismiss":"modal"}},[t._v(" Close ")]),"new"==t.modal?a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.addSession()}}},[t._v(" Save changes ")]):t._e(),"edit"==t.modal?a("button",{staticClass:"btn btn-primary",attrs:{type:"button"},on:{click:function(e){return t.updateModule()}}},[t._v(" Apply changes ")]):t._e()])])])])])},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"headind_srch"},[a("div",{staticClass:"recent_heading"},[a("h4",[t._v("Recent")])]),a("div",{staticClass:"srch_bar"},[a("div",{staticClass:"stylish-input-group"},[a("input",{staticClass:"search-bar",attrs:{type:"text",placeholder:"Search"}}),a("span",{staticClass:"input-group-addon"},[a("button",{attrs:{type:"button"}},[a("i",{staticClass:"fa fa-search",attrs:{"aria-hidden":"true"}})])])])])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("button",{staticClass:"msg_send_btn",attrs:{type:"button"}},[a("i",{staticClass:"fa fa-paper-plane-o",attrs:{"aria-hidden":"true"}})])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"modal-header"},[a("h5",{staticClass:"modal-title",attrs:{id:"editLabel"}},[t._v("Schedule a date!")]),a("button",{staticClass:"close",attrs:{type:"button","data-dismiss":"modal","aria-label":"Close"}},[a("span",{attrs:{"aria-hidden":"true"}},[t._v("Ã—")])])])}],n=a("8aa5"),o=a.n(n),c={name:"Chat",data:function(){return{message:null,messages:[],authUser:{},receipient:"",contacts:[],modal:null,date:(new Date).toISOString().substr(0,10),menu:!1,menu2:!1,time:new Date,module:null}},methods:{saveMessage:function(){var t=this;null!=this.message?db.collection("chat").add({message:this.message,author:this.authUser.email,createdAt:new Date,receipient:this.receipient,auth_rec:this.authUser.email.concat(this.receipient).length}).then((function(){t.scrollToBottom()})):alert("Enter message first"),this.message=null},fetchMessages:function(){var t=this;this.receipient?db.collection("chat").where("auth_rec","==",o.a.auth().currentUser.email.concat(this.receipient).length).orderBy("createdAt").onSnapshot((function(e){var a=[];e.forEach((function(t){a.push(t.data())})),t.messages=a,setTimeout((function(){t.scrollToBottom()}),1e3)})):console.log("no receipient")},fetchContacts:function(){var t=this;o.a.auth().onAuthStateChanged((function(e){e&&db.collection("users").doc(e.uid).collection("contacts").onSnapshot((function(e){var a=[];e.forEach((function(t){var e=t.data().name;console.log("email",e),db.collection("users").where("email","==",e).get().then((function(t){t.forEach((function(t){console.log(t.data()),a.push(t.data())}))}))})),t.contacts=a}))}))},scrollToBottom:function(){var t=document.querySelector(".msg_history");t.scrollTop=t.scrollHeight},select:function(t){this.receipient=t},addNew:function(){this.modal="new",$("#module").modal("show")},addSession:function(){var t=this;db.collection("studentrequests").doc(o.a.auth().currentUser.uid).set({date:this.submittableDateTime,author:o.a.auth().currentUser.email,receipient:this.receipient,created:new Date,module:this.module,accepted:!1,uid:o.a.auth().currentUser.uid,auth_rec:o.a.auth().currentUser.email.concat(this.receipient).length}).then((function(){t.modal=null}))}},created:function(){var t=this;o.a.auth().onAuthStateChanged((function(e){t.authUser=e||{}})),this.fetchContacts()},computed:{submittableDateTime:function(){var t=new Date(this.date);if("string"===typeof this.time){var e=this.time.match(/^(\d+)/)[1],a=this.time.match(/:(\d+)/)[1];t.setHours(e),t.setMinutes(a)}else t.setHours(this.time.getHours()),t.setMinutes(this.time.getMinutes());return t}},beforeRouteEnter:function(t,e,a){a((function(t){o.a.auth().onAuthStateChanged((function(e){e?a():t.$router.push("/login")}))}))}},r=c,l=(a("72ca"),a("2877")),u=Object(l["a"])(r,s,i,!1,null,"c93f8c2e",null);e["default"]=u.exports},f072:function(t,e,a){}}]);
//# sourceMappingURL=chunk-1ba3778b.267f96af.js.map